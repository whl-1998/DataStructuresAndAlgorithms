### 自连接 + 左连接+分组查询

思路：

* 首先明确题意，需要获取到 “不同帖子的评论数” ，那么我们就需要采用自连接，因为帖子的Id和评论的Id都在Submissions 表中。然后对检索的结果按照帖子的Id进行分组，并去除重复的评论数：

  ```mysql
  select s1.sub_id as post_id, count(distinct(s2.sub_id)) as number_of_comments
  from Submissions s1 join Submissions s2 on s1.sub_id = s2.parent_id
  group by s1.sub_id;
  ```

* 上述语句我们能够获取到这个结果："values": [[1, 3], [2, 2]]

* 这是因为，内连接只能获取到二者的交集，也就是 s1.sub_id = s2.parent_id 的结果集

* 为了保证能够获取到sub_id为空的结果集，我们将 s1 作为主表进行左连接，

* 其次，我们获取到的结果集要求是按帖子进行分组的，这就意味着我们需要筛选出 parent_id is null 的部分：

```mysql
select s1.sub_id as post_id, count(distinct(s2.sub_id), 0) number_of_comments
from Submissions s1 left join Submissions s2
on s1.sub_id = s2.parent_id
where s1.parent_id is null
group by s1.sub_id;
```

